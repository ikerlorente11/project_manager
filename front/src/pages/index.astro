---
// Import necessary components and layouts
import Project from "../components/Project.astro"; // Component to display individual projects
import Button from "../components/Button.astro"; // Button component for creating new projects
import Layout from "../layouts/Layout.astro"; // Layout component for consistent page structure

// Disable prerendering for this page
export const prerender = false;

// Import environment variables for API base URLs
import { SERVER_API_BASE_URL, BASE_URL } from "astro:env/server";

// Fetch the list of projects from the server API
const response = await fetch(`${SERVER_API_BASE_URL}projects`); // Make a GET request to the projects endpoint
const projects = await response.json(); // Parse the response as JSON
---

<!-- Main layout for the page -->
<Layout>
	<!-- Container for displaying the list of projects -->
	<div class="projects">
		{projects.map((project) => <Project {...project} />)}
	</div>
	<!-- Button to create a new project -->
	<Button
		url=`${BASE_URL || "/"}projects/new`
		text="Nuevo proyecto"
		style="default"
		css="mb-1 mt-1"
	/>
</Layout>

<style>
	.projects {
		display: flex;
		flex-direction: column;
		margin-top: 1.5rem;
		gap: 0.8rem;
		flex-grow: 1;
		overflow-y: overlay;
		padding: 7px 0;
	}
</style>
